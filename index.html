<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Certificate Generator</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f7f8fc; padding: 40px; display: flex; flex-direction: column; align-items: center; }
    .card { background: #fff; padding: 30px; border-radius: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); max-width: 500px; width: 100%; }
    input, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
    button { background: #28a745; color: white; font-weight: bold; border: none; cursor: pointer; transition: 0.3s; }
    button:hover { background: #218838; }
    .spinner { display: none; margin-top: 20px; }
    .result { display: none; text-align: center; margin-top: 30px; }
    iframe { width: 100%; height: 500px; border: none; border-radius: 10px; }
    img.qr { margin-bottom: 15px; width: 150px; }
    .download-btn { background: #28a745; color: #fff; text-decoration: none; padding: 10px 16px; border-radius: 8px; display: inline-block; margin-top: 15px; }
  </style>
</head>
<body>
  <div class="card">
    <h2>Generate Certificate</h2>
    <form id="certForm">
      <input type="text" id="name" placeholder="Name" required>
      <input type="text" id="fatherName" placeholder="Father/Husband Name" required>
      <input type="email" id="email" placeholder="Email" required>
      <input type="tel" id="mobile" placeholder="Mobile Number" required>
      <button type="submit">Submit</button>
    </form>
    <div class="spinner" id="spinner">‚è≥ Generating Certificate...</div>
    <div class="result" id="result">
      <img id="qr" class="qr" alt="QR Code">
      <iframe id="preview"></iframe><br>
      <a id="download" class="download-btn" target="_blank">Download Certificate</a>
    </div>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxAsf74wdEkw2lT279LWEsUqS1E62Fu1gAR75Q8qkJMpi_LG4mVTxtS7vzevM07ilRz/exec"; // Replace with your Web App URL

    document.getElementById("certForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const spinner = document.getElementById("spinner");
      const result = document.getElementById("result");
      spinner.style.display = "block";
      result.style.display = "none";

      const formData = {
        name: document.getElementById("name").value,
        fatherName: document.getElementById("fatherName").value,
        email: document.getElementById("email").value,
        mobile: document.getElementById("mobile").value
      };

      try {
        const res = await fetch(scriptURL, {
          method: "POST",
          mode: "cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(formData)
          });
        const data = await res.json();
        spinner.style.display = "none";

        if (data.status === "success") {
          document.getElementById("qr").src = data.qrUrl;
          document.getElementById("preview").src = data.certUrl.replace("/edit", "/preview");
          document.getElementById("download").href = data.certUrl.replace("/edit", "/export?format=pdf");
          result.style.display = "block";
        } else {
          alert("Error: " + data.message);
        }
      } catch (err) {
        spinner.style.display = "none";
        alert("Error submitting form: " + err.message);
      }
    });
  </script>
</body>
</html>


